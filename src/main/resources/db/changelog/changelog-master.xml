<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd
    http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

    <changeSet id="001" author="rajnikant">
        <sql>
            CREATE TABLE "user"
            (
            id               INT8         NOT NULL GENERATED BY DEFAULT AS IDENTITY,
            email            VARCHAR(40)  NULL,
            password         VARCHAR(100) NULL,
            username         VARCHAR(55)  NULL,
            CONSTRAINT user_pkey PRIMARY KEY (ID),
            CONSTRAINT uk_user_email UNIQUE (EMAIL),
            CONSTRAINT uk_user_username UNIQUE (USERNAME)
            );

            CREATE TABLE "roles"
            (
            id     INT        NOT NULL GENERATED BY DEFAULT AS IDENTITY,
            "name" VARCHAR(60) NULL,
            CONSTRAINT role_pkey PRIMARY KEY (id),
            CONSTRAINT uk_role_name UNIQUE ("name")
            );

            CREATE TABLE user_roles
            (
            user_id INT8 NOT NULL,
            role_id INT NOT NULL,
            CONSTRAINT user_role_pkey PRIMARY KEY (user_id, role_id),
            CONSTRAINT fk_ur_role FOREIGN KEY (role_id) REFERENCES "roles" (id),
            CONSTRAINT fk_ur_user FOREIGN KEY (user_id) REFERENCES "user" (id)
            );
        </sql>
    </changeSet>
</databaseChangeLog>